<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chapter 20, Vignette 3: PROPROC ROCs and pdfs • RJafroc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 20, Vignette 3: PROPROC ROCs and pdfs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RJafroc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/QuickStartDBMHCh10V1.html">Chapter 10, Vignette 1: Quick Start: Running DBMH-ORH analysis</a>
    </li>
    <li>
      <a href="../articles/QuickStartDBMHExcelOutputCh10V2.html">Chapter 10, Vignette 2: Quick Start DBMH-ORH Analysis with Excel Output</a>
    </li>
    <li>
      <a href="../articles/SampleSizeCh11V1.html">Chapter 11, Vignette 1: Background on the F distribution</a>
    </li>
    <li>
      <a href="../articles/SampleSizeCh11V2.html">Chapter 11, Vignette 2: ROC-DBMH sample size from first principles</a>
    </li>
    <li>
      <a href="../articles/SampleSizeCh11V3.html">Chapter 11, Vignette 3: RJafroc functions for ROC sample size estimation using DBMH method</a>
    </li>
    <li>
      <a href="../articles/SampleSizeCh11V4.html">Chapter 11, Vignette 4: RJafroc functions for ROC sample size estimation using ORH method</a>
    </li>
    <li>
      <a href="../articles/cbmPlotsCh20V5.html">Chapter 20, Vignette 5: CBM plots</a>
    </li>
    <li>
      <a href="../articles/degenerateROCsCh20V2.html">Chapter 20, Vignette 2: Degenerate datasets in the binormal model</a>
    </li>
    <li>
      <a href="../articles/improperROCsCh20V1.html">Chapter 20, Vignette 1: Improper ROCs</a>
    </li>
    <li>
      <a href="../articles/metzEqn36Ch20V4.html">Chapter 20, Vignette 4: Metz Eqn36 numerical check</a>
    </li>
    <li>
      <a href="../articles/proprocROCsCh20V3.html">Chapter 20, Vignette 3: PROPROC ROCs and pdfs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Chapter 20, Vignette 3: PROPROC ROCs and pdfs</h1>
                        <h4 class="author">Dev P. Chakraborty</h4>
            
            <h4 class="date">2018-11-27</h4>
      
      
      <div class="hidden name"><code>proprocROCsCh20V3.Rmd</code></div>

    </div>

    
    
<div id="helper-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#helper-functions" class="anchor"></a>Helper functions</h2>
</div>
<div id="definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters" class="anchor"></a>Definitions of PROPROC parameters in terms of binormal model parameters</h2>
<p><span class="math display">\[c=\frac{b-1}{b+1};{{d}_{a}}=\frac{\sqrt{2}a}{\sqrt{1+{{b}^{2}}}}\]</span></p>
</div>
<div id="main-code-and-output" class="section level2">
<h2 class="hasAnchor">
<a href="#main-code-and-output" class="anchor"></a>Main code and output</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c1Arr &lt;-<span class="st">   </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">0.1322804</span>, <span class="fl">0.2225588</span>); daArr  &lt;-<span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">1.197239</span>, <span class="fl">1.740157</span>)
myLabel &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>)
myLabelIndx &lt;-<span class="st"> </span><span class="dv">1</span>
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)
{
  c1 &lt;-<span class="st"> </span>c1Arr[i]
  da &lt;-<span class="st"> </span>daArr[i]
  ret &lt;-<span class="st"> </span><span class="kw">Transform2ab</span>(da, c1)
  a &lt;-<span class="st"> </span>ret<span class="op">$</span>a;b &lt;-<span class="st"> </span>ret<span class="op">$</span>b
  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">0</span>, <span class="dt">by =</span> <span class="fl">0.01</span>) <span class="co"># may need to adjust limits to view detail of slope plot</span>
  <span class="cf">if</span> (i <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) z &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>) <span class="co"># may need to adjust limits to view detail of slope plot</span>
  
  FPF &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.0</span>, <span class="dv">1</span>, <span class="fl">0.001</span>)
  TPF &lt;-<span class="st"> </span><span class="kw">rocY</span>(FPF, a, b)
  
  rocPlot &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">FPF =</span> FPF, <span class="dt">TPF =</span> TPF)
  plotRoc &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rocPlot, <span class="kw">aes</span>(<span class="dt">x =</span> FPF, <span class="dt">y =</span> TPF)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>()  <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>))   <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(myLabel[myLabelIndx]);myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span>

  slope &lt;-b<span class="op">*</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(a<span class="op">-</span>b<span class="op">*</span>z)<span class="op">/</span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">dnorm</a></span>(<span class="op">-</span>z) <span class="co"># same as likelihood ratio</span>
  
  slopePlot &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">z =</span> z, <span class="dt">slope =</span> slope)
  p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(slopePlot, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> slope)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_line</span>()  <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">0</span>))  <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(myLabel[myLabelIndx]);myLabelIndx &lt;-<span class="st"> </span>myLabelIndx <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(plotRoc);<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(p)
}</code></pre></div>
<p><img src="proprocROCsCh20V3_files/figure-html/unnamed-chunk-2-1.png" width="700"><img src="proprocROCsCh20V3_files/figure-html/unnamed-chunk-2-2.png" width="700"><img src="proprocROCsCh20V3_files/figure-html/unnamed-chunk-2-3.png" width="700"><img src="proprocROCsCh20V3_files/figure-html/unnamed-chunk-2-4.png" width="700"></p>
</div>
<div id="discussion" class="section level2">
<h2 class="hasAnchor">
<a href="#discussion" class="anchor"></a>Discussion</h2>
<p>Plot A is for <code>c1</code> = -0.1322804, <code>da</code> = 1.197239 while plot C is for <code>c1</code> = 0.2225588, <code>da</code> = 1.740157. Plots B and D are the corresponding slope plots as functions of the binormal model z-sample. In plot A, the slope is infinite near the origin and the curve approaches the upper-right corner with finite slope. The situation is reversed in plot C where the slope is finite near the origin and the curve approaches the upper-right corner with zero slope.</p>
<p>These two readers are from a clinical dataset, <code>dataset01</code>. Highest rating inferred ROC data from original FROC data, were analyzed by PROPROC and the resulting parameter values are coded here. They were chosen as they demonstrate key differences in the shapes of proper ROC plots. Plot A corresponds to a negative value of <code>c1</code>, which implies <code>b &lt; 1</code>. The slope of the proper ROC is infinite near the origin and approaches a positive constant near the upper right corner of the ROC. Plot C is for a positive value of <code>c1</code>, i.e., for <code>b &gt; 1</code>. Now the slope of the proper ROC is finite near the origin and approaches zero near the upper right corner.</p>
<p>Considering plot D, as one “cuts” the slope axis horizontally with a sliding threshold, starting with very high values and moving downwards, the slope of the ROC curve starts at the origin with a large but finite value. This corresponds to the peak in plot D. Above the peak, there are no solutions for <code>z</code>. The slope decreases monotonically to zero, corresponding to the flattening out of the slope at zero for <code>z ~  -2</code>.</p>
<p>The two values of <code>z</code> corresponding to each cut implies, of course, that the binormal model based proper algorithm has to do a lot of bookkeeping, since each horizontal cut splits the decision axis into 3 regions. One can think of shrinking each of plots B &amp; D horizontally to zero width, and all that remains is the slope axis with a thick vertical line superimposed on it, corresponding to the horizontally collapsed curves. In plot B the vertical line extends from positive infinity down to about 0.1, and represents the range of decision variable samples encountered by the observer on the likelihood ratio scale. In plot D the vertical line extends from a finite value (~9.4) to zero. For the stated binormal model parameters values outside of these ranges are not possible.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#helper-functions">Helper functions</a></li>
      <li><a href="#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters">Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
      <li><a href="#main-code-and-output">Main code and output</a></li>
      <li><a href="#discussion">Discussion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Dev Chakraborty, Xuetong Zhai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
