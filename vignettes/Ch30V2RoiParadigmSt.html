<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dev P. Chakraborty" />

<meta name="date" content="2018-12-07" />

<title>Chapter 30, Vignette 2: Significance testing for the ROI paradigm</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */


</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Chapter 30, Vignette 2: Significance testing for the ROI paradigm</h1>
<h4 class="author"><em>Dev P. Chakraborty</em></h4>
<h4 class="date"><em>2018-12-07</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<ul>
<li><p>For an ROI dataset calling <code>StSignificanceTesting()</code> automatically defaults to <code>method = &quot;ORH&quot;</code>, <code>covEstMethod = &quot;DeLong&quot;</code> and <code>FOM = &quot;ROI&quot;</code>.</p></li>
<li><p>The covariance estimation method is based on the original DeLong method <span class="citation">(E. R. DeLong, DeLong, and Clarke-Pearson 1988)</span>, which is valid only for the trapezoidal AUC, i.e.Â ROC data, as extended by <span class="citation">(Nancy A. Obuchowski 1997)</span> to ROI data.</p></li>
<li><p>The essential differences from conventional ROC analyses are in the definition of the ROI figure of merit, see below, and the procedure developed by <span class="citation">(Nancy A. Obuchowski 1997)</span> for estimating the covariance matrix. Once the covariances are known, <code>method = &quot;ORH&quot;</code> can be applied to perform significance testing, as described in <span class="citation">(N. A. Obuchowski and Rockette 1995)</span> and <span class="citation">(Chakraborty 2017, Chapter 10)</span>.</p></li>
</ul>
</div>
<div id="the-roi-figure-of-merit" class="section level2">
<h2>The ROI figure of merit</h2>
<p>Let <span class="math inline">\({{X}_{kr}}\)</span> denote the rating for the r<sup>th</sup> <strong>lesion-containing</strong> ROI in the k<sup>th</sup> case and let <span class="math inline">\(n_{k}^{L}\)</span> be the total number of lesion-containing ROIs in the k<sup>th</sup> case. Similarly, let <span class="math inline">\({{Y}_{kr}}\)</span> denote the rating for the r<sup>th</sup> <strong>lesion-free</strong> ROI in the k<sup>th</sup> case and <span class="math inline">\(n_{k}^{N}\)</span> denote the total number of lesion-free ROIs in the k<sup>th</sup> case. Let <span class="math inline">\({{N}_{L}}\)</span> denote the total number of lesion-containing ROIs in the image set and <span class="math inline">\({{N}_{N}}\)</span> denote the total number of lesion-free ROIs. These are given by <span class="math inline">\({{N}_{L}}=\sum\nolimits_{k}{n_{k}^{L}}\)</span> and <span class="math inline">\({{N}_{N}}=\sum\nolimits_{k}{n_{k}^{N}}\)</span>. The ROI figure of merit <span class="math inline">\(\theta\)</span>Â is defined by: <span class="math display">\[\theta =\frac{1}{{{N}_{L}}{{N}_{N}}}\sum\nolimits_{k}{\sum\nolimits_{{{k}'}}{\sum\limits_{r=1}^{n_{k}^{L}}{\sum\limits_{{r}'=1}^{n_{k'}^{N}}{\psi ({{X}_{kr}},{{Y}_{{k}'{r}'}})}}}}\]</span></p>
<p>Here the kernel function is defined by:</p>
<p><span class="math display">\[\psi (X,Y)=\left\{ \begin{align}
  &amp; 1.0\ \ \ \text{if}\ Y&lt;X \\ 
 &amp; 0.5\ \ \ \text{if}\ Y=X \\ 
 &amp; 0.0\ \ \ \text{if}\ Y&gt;X \\ 
\end{align} \right.\]</span></p>
<p>The ROIs are <em>effectively regarded as mini-cases</em> and one calculates the FOM as the Wilcoxon statistic considering the mini-cases as actual cases. The correlations between the ratings of ROIs on the same case are accounted for in the analysis.</p>
</div>
<div id="calculation-of-the-roi-figure-of-merit." class="section level2">
<h2>Calculation of the ROI figure of merit.</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UtilFigureOfMerit</span>(datasetROI)
<span class="co">#&gt; Incorrect FOM supplied, changing to 'ROI'</span>
<span class="co">#&gt;           Rdr - 1   Rdr - 2   Rdr - 3   Rdr - 4   Rdr - 5</span>
<span class="co">#&gt; Trt - 1 0.9057239 0.8842834 0.8579279 0.9350207 0.8352103</span>
<span class="co">#&gt; Trt - 2 0.9297186 0.9546035 0.8937652 0.9531716 0.8770076</span>
fom &lt;-<span class="st"> </span><span class="kw">UtilFigureOfMerit</span>(datasetROI, <span class="dt">FOM =</span> <span class="st">&quot;ROI&quot;</span>)</code></pre></div>
<ul>
<li>If the correct <code>FOM</code> is not supplied, it defaults to <code>FOM = ROI</code>.<br />
</li>
<li>This is a 2-treatment 5-reader dataset.<br />
</li>
<li>For treatment 1, reader 1 the figure of merit is 0.9057239.<br />
</li>
<li>For treatment 2, reader 5 the figure of merit is 0.8770076.<br />
</li>
<li>Etc.</li>
</ul>
</div>
<div id="significance-testing" class="section level2">
<h2>Significance testing</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(datasetROI)
<span class="co">#&gt; ROI dataset: using method = `ORH`, covEstMethod = `DeLong` and FOM = `ROI`.</span>
<span class="kw">str</span>(ret)
<span class="co">#&gt; List of 22</span>
<span class="co">#&gt;  $ fomArray           : num [1:2, 1:5] 0.906 0.93 0.884 0.955 0.858 ...</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;Trt - 1&quot; &quot;Trt - 2&quot;</span>
<span class="co">#&gt;   .. ..$ : chr [1:5] &quot;Rdr - 1&quot; &quot;Rdr - 2&quot; &quot;Rdr - 3&quot; &quot;Rdr - 4&quot; ...</span>
<span class="co">#&gt;  $ msT                : num 0.00361</span>
<span class="co">#&gt;  $ msTR               : num 0.000207</span>
<span class="co">#&gt;  $ varComp            :'data.frame': 6 obs. of  1 variable:</span>
<span class="co">#&gt;   ..$ varCov: num [1:6] 0.001082 0.000153 0.000247 0.000187 0.000154 ...</span>
<span class="co">#&gt;  $ fRRRC              : num 9.76</span>
<span class="co">#&gt;  $ ndf                : num 1</span>
<span class="co">#&gt;  $ ddfRRRC            : num 12.8</span>
<span class="co">#&gt;  $ pRRRC              : num 0.00817</span>
<span class="co">#&gt;  $ ciDiffTrtRRRC      :'data.frame': 1 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ Treatment: chr &quot;1 - 2&quot;</span>
<span class="co">#&gt;   ..$ Estimate : num -0.038</span>
<span class="co">#&gt;   ..$ StdErr   : num 0.0122</span>
<span class="co">#&gt;   ..$ DF       : num 12.8</span>
<span class="co">#&gt;   ..$ t        : num -3.12</span>
<span class="co">#&gt;   ..$ PrGTt    : num 0.00817</span>
<span class="co">#&gt;   ..$ CILower  : num -0.0643</span>
<span class="co">#&gt;   ..$ CIUpper  : num -0.0117</span>
<span class="co">#&gt;  $ ciAvgRdrEachTrtRRRC:'data.frame': 2 obs. of  6 variables:</span>
<span class="co">#&gt;   ..$ Treatment: Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 2</span>
<span class="co">#&gt;   ..$ Area     : num [1:2] 0.884 0.922</span>
<span class="co">#&gt;   ..$ StdErr   : num [1:2(1d)] 0.0232 0.0197</span>
<span class="co">#&gt;   ..$ DF       : num [1:2(1d)] 12.2 10.1</span>
<span class="co">#&gt;   ..$ CILower  : num [1:2] 0.833 0.878</span>
<span class="co">#&gt;   ..$ CIUpper  : num [1:2] 0.934 0.966</span>
<span class="co">#&gt;  $ fFRRC              : num 16.6</span>
<span class="co">#&gt;  $ ddfFRRC            : num Inf</span>
<span class="co">#&gt;  $ pFRRC              : num 4.58e-05</span>
<span class="co">#&gt;  $ ciDiffTrtFRRC      :'data.frame': 1 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ Treatment: chr &quot;1 - 2&quot;</span>
<span class="co">#&gt;   ..$ Estimate : num -0.038</span>
<span class="co">#&gt;   ..$ StdErr   : num 0.00933</span>
<span class="co">#&gt;   ..$ DF       : num Inf</span>
<span class="co">#&gt;   ..$ t        : num -4.08</span>
<span class="co">#&gt;   ..$ PrGTt    : num 4.58e-05</span>
<span class="co">#&gt;   ..$ CILower  : num -0.0563</span>
<span class="co">#&gt;   ..$ CIUpper  : num -0.0197</span>
<span class="co">#&gt;  $ ciAvgRdrEachTrtFRRC:'data.frame': 2 obs. of  6 variables:</span>
<span class="co">#&gt;   ..$ Treatment: Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 2</span>
<span class="co">#&gt;   ..$ Area     : num [1:2] 0.884 0.922</span>
<span class="co">#&gt;   ..$ StdErr   : num [1:2(1d)] 0.0163 0.0129</span>
<span class="co">#&gt;   ..$ DF       : num [1:2(1d)] Inf Inf</span>
<span class="co">#&gt;   ..$ CILower  : num [1:2] 0.852 0.896</span>
<span class="co">#&gt;   ..$ CIUpper  : num [1:2] 0.916 0.947</span>
<span class="co">#&gt;  $ ciDiffTrtEachRdr   :'data.frame': 5 obs. of  9 variables:</span>
<span class="co">#&gt;   ..$ Reader   : Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5</span>
<span class="co">#&gt;   ..$ Treatment: Factor w/ 1 level &quot;1 - 2&quot;: 1 1 1 1 1</span>
<span class="co">#&gt;   ..$ Estimate : num [1:5] -0.024 -0.0703 -0.0358 -0.0182 -0.0418</span>
<span class="co">#&gt;   ..$ StdErr   : num [1:5] 0.01025 0.01448 0.01648 0.00928 0.01398</span>
<span class="co">#&gt;   ..$ DF       : num [1:5] Inf Inf Inf Inf Inf</span>
<span class="co">#&gt;   ..$ t        : num [1:5] -2.34 -4.86 -2.17 -1.96 -2.99</span>
<span class="co">#&gt;   ..$ PrGTt    : num [1:5] 1.93e-02 1.20e-06 2.97e-02 5.05e-02 2.79e-03</span>
<span class="co">#&gt;   ..$ CILower  : num [1:5] -0.0441 -0.0987 -0.0681 -0.0363 -0.0692</span>
<span class="co">#&gt;   ..$ CIUpper  : num [1:5] -3.90e-03 -4.19e-02 -3.53e-03 3.88e-05 -1.44e-02</span>
<span class="co">#&gt;  $ varCovEachRdr      :'data.frame': 5 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ Reader: Factor w/ 5 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 3 4 5</span>
<span class="co">#&gt;   ..$ Var   : num [1:5] 0.000269 0.000227 0.000481 0.000168 0.000522</span>
<span class="co">#&gt;   ..$ Cov1  : num [1:5] 0.000216 0.000122 0.000345 0.000125 0.000424</span>
<span class="co">#&gt;  $ fRRFC              : num 17.5</span>
<span class="co">#&gt;  $ ddfRRFC            : num 4</span>
<span class="co">#&gt;  $ pRRFC              : num 0.0139</span>
<span class="co">#&gt;  $ ciDiffTrtRRFC      :'data.frame': 1 obs. of  8 variables:</span>
<span class="co">#&gt;   ..$ Treatment: chr &quot;1 - 2&quot;</span>
<span class="co">#&gt;   ..$ Estimate : num -0.038</span>
<span class="co">#&gt;   ..$ StdErr   : num 0.00909</span>
<span class="co">#&gt;   ..$ DF       : num 4</span>
<span class="co">#&gt;   ..$ t        : num -4.18</span>
<span class="co">#&gt;   ..$ PrGTt    : num 0.0139</span>
<span class="co">#&gt;   ..$ CILower  : num -0.0633</span>
<span class="co">#&gt;   ..$ CIUpper  : num -0.0128</span>
<span class="co">#&gt;  $ ciAvgRdrEachTrtRRFC:'data.frame': 2 obs. of  6 variables:</span>
<span class="co">#&gt;   ..$ Treatment: Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 2</span>
<span class="co">#&gt;   ..$ Area     : num [1:2] 0.884 0.922</span>
<span class="co">#&gt;   ..$ StdErr   : num [1:2(1d)] 0.0175 0.0157</span>
<span class="co">#&gt;   ..$ DF       : num [1:2(1d)] 4 4</span>
<span class="co">#&gt;   ..$ CILower  : num [1:2] 0.835 0.878</span>
<span class="co">#&gt;   ..$ CIUpper  : num [1:2] 0.932 0.965</span></code></pre></div>
<ul>
<li><p>While <code>ret</code> is a list with many (22) members, their meanings should be clear from the notation. As an example:</p></li>
<li><p>The variance components are given by:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>varComp
<span class="co">#&gt;                  varCov</span>
<span class="co">#&gt; Var(R)     0.0010823592</span>
<span class="co">#&gt; Var(T*R)   0.0001526084</span>
<span class="co">#&gt; COV1       0.0002465125</span>
<span class="co">#&gt; COV2       0.0001870571</span>
<span class="co">#&gt; COV3       0.0001543764</span>
<span class="co">#&gt; Var(Error) 0.0003333119</span></code></pre></div>
<div id="rrrc-analysis" class="section level3">
<h3>RRRC analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>fRRRC
<span class="co">#&gt; [1] 9.763602</span>
ret<span class="op">$</span>ddfRRRC
<span class="co">#&gt; [1] 12.82259</span>
ret<span class="op">$</span>pRRRC
<span class="co">#&gt; [1] 0.008173042</span></code></pre></div>
<ul>
<li><p>The F-statistic is 9.7636016, with <code>ndf = 1</code> and <code>ddf</code> = 12.8225898, which yields a p-value of 0.008173.</p></li>
<li><p>The confidence interval for the reader averaged difference between the two treatments is given by:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>ciDiffTrtRRRC
<span class="co">#&gt;   Treatment    Estimate     StdErr       DF         t       PrGTt</span>
<span class="co">#&gt; 1     1 - 2 -0.03802005 0.01216768 12.82259 -3.124676 0.008173042</span>
<span class="co">#&gt;       CILower     CIUpper</span>
<span class="co">#&gt; 1 -0.06434373 -0.01169636</span></code></pre></div>
<ul>
<li>The FOm difference treatment 1 minus 2 is -0.03802, which is significant, p-value = 0.008173, F-statistic = 9.7636016, ddf = 12.8225898. The confidence interval is (-0.0643437, -0.0116964).</li>
</ul>
</div>
<div id="frrc-analysis" class="section level3">
<h3>FRRC analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>fFRRC
<span class="co">#&gt; [1] 16.6135</span>
ret<span class="op">$</span>ddfFRRC
<span class="co">#&gt; [1] Inf</span>
ret<span class="op">$</span>pFRRC
<span class="co">#&gt; [1] 4.582365e-05</span></code></pre></div>
<ul>
<li><p>The F-statistic is 16.6135014, with <code>ndf = 1</code> and <code>ddf</code> = <code>Inf</code>, which yields a p-value of 4.582365110^{-5}.</p></li>
<li><p>The confidence interval for the reader averaged difference between the two treatments is given by:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>ciDiffTrtFRRC
<span class="co">#&gt;   Treatment    Estimate      StdErr  DF         t        PrGTt     CILower</span>
<span class="co">#&gt; 1     1 - 2 -0.03802005 0.009327861 Inf -4.075966 4.582365e-05 -0.05630232</span>
<span class="co">#&gt;       CIUpper</span>
<span class="co">#&gt; 1 -0.01973778</span></code></pre></div>
</div>
<div id="rrfc-analysis" class="section level3">
<h3>RRFC analysis</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>fRRFC
<span class="co">#&gt; [1] 17.48107</span>
ret<span class="op">$</span>ddfRRFC
<span class="co">#&gt; [1] 4</span>
ret<span class="op">$</span>pRRFC
<span class="co">#&gt; [1] 0.01390667</span></code></pre></div>
<ul>
<li><p>The F-statistic is 17.4810666, with <code>ndf = 1</code> and <code>ddf</code> = 4, which yields a p-value of 0.0139067.</p></li>
<li><p>The confidence interval for the reader averaged difference between the two treatments is given by:</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ret<span class="op">$</span>ciDiffTrtRRFC
<span class="co">#&gt;   Treatment    Estimate     StdErr DF         t      PrGTt     CILower</span>
<span class="co">#&gt; 1     1 - 2 -0.03802005 0.00909345  4 -4.181037 0.01390667 -0.06326751</span>
<span class="co">#&gt;       CIUpper</span>
<span class="co">#&gt; 1 -0.01277258</span></code></pre></div>
</div>
</div>
<div id="summary" class="section level2">
<h2>Summary</h2>
<p>The list variable <code>ret</code> also contains the results of <code>FRRC</code> and <code>RRFC</code> analyses. Extractin them is left as an exercise to the reader.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-RN2680">
<p>Chakraborty, Dev P. 2017. <em>Observer Performance Methods for Diagnostic Imaging - Foundations, Modeling, and Applications with R-Based Examples</em>. Book. Boca Raton, FL: CRC Press.</p>
</div>
<div id="ref-RN112">
<p>DeLong, E. R., D. M. DeLong, and D. L. Clarke-Pearson. 1988. âComparing the Areas Under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric Approach.â Journal Article. <em>Biometrics</em> 44: 837â45.</p>
</div>
<div id="ref-RN1450">
<p>Obuchowski, N. A., and H.E. Rockette. 1995. âHypothesis Testing of the Diagnostic Accuracy for Multiple Diagnostic Tests: An Anova Approach with Dependent Observations.â Journal Article. <em>Communications in Statistics: Simulation and Computation</em> 24: 285â308.</p>
</div>
<div id="ref-RN1233">
<p>Obuchowski, Nancy A. 1997. âNonparametric Analysis of Clustered Roc Curve Data.â Journal Article. <em>Biometrics</em> 53: 567â78.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
